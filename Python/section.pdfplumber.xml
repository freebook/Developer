<?xml version="1.0" encoding="UTF-8"?>
<section>
	<title>PDF 文件处理</title>
	<subtitle>Plumb a PDF for detailed information about each char, rectangle, and line.</subtitle>
	<section>
		<title>安装</title>
		<screen>
		<![CDATA[
neo@MacBook-Pro-Neo ~/workspace/python % pip install pdfplumber		
		]]>
		</screen>
		<screen>
		<![CDATA[
neo@MacBook-Pro-Neo ~/workspace/python % pip show pdfplumber
Name: pdfplumber
Version: 0.5.26
Summary: Plumb a PDF for detailed information about each char, rectangle, and line.
Home-page: https://github.com/jsvine/pdfplumber
Author: Jeremy Singer-Vine
Author-email: jsvine@gmail.com
License: UNKNOWN
Location: /Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages
Requires: pdfminer.six, Pillow, Wand
Required-by: 		
		]]>
		</screen>
	</section>
	<section>
		<title>获取PDF文档信息</title>
		<programlisting>
		<![CDATA[
import os,pdfplumber
import pandas as pd

file = os.path.expanduser("~/tmp/每日开放式基金净值表.pdf")

with pdfplumber.open(file) as pdf:
    print(pdf.metadata)		
		]]>
		</programlisting>
		<para>输出结果</para>
		<screen>
		<![CDATA[
{'Producer': 'macOS 版本11.2.1（版号20D74） Quartz PDFContext', 'CreationDate': "D:20210227145013Z00'00'", 'ModDate': "D:20210227145013Z00'00'"}		
		]]>
		</screen>
	</section>
	<section>
		<title>获取PDF总页数</title>
		<programlisting>
		<![CDATA[
import os,pdfplumber
import pandas as pd

file = os.path.expanduser("~/tmp/每日开放式基金净值表.pdf")

with pdfplumber.open(file) as pdf:
    print(len(pdf.pages))		
		]]>
		</programlisting>
	</section>
	<section>
		<title>查看PDF页面信息</title>
		<programlisting>
		<![CDATA[
import os,pdfplumber
import pandas as pd

file = os.path.expanduser("~/tmp/每日开放式基金净值表.pdf")

with pdfplumber.open(file) as pdf:

    first_page = pdf.pages[0]
    
    # 查看当前页码
    print('页码：',first_page.page_number)

    # 查看当前页宽
    print('页宽：',first_page.width)

    # 查看当前页高
    print('页高：',first_page.height)		
		]]>
		</programlisting>
	</section>
	<section>
		<title>提取文本内容</title>
		<programlisting>
		<![CDATA[
import os,pdfplumber
import pandas as pd

file = os.path.expanduser("~/tmp/每日开放式基金净值表.pdf")

with pdfplumber.open(file) as pdf:

    first_page = pdf.pages[0]
    
    # 读取文本
    text = first_page.extract_text()
    print(text)		
		]]>
		</programlisting>
	</section>
	
	<section>
		<title>提取pdf中的表格数据</title>
		<programlisting>
		<![CDATA[
import os,pdfplumber
import pandas as pd

file = os.path.expanduser("~/tmp/每日开放式基金净值表.pdf")

with pdfplumber.open(file) as pdf:
    first_page = pdf.pages[0]
    table = first_page.extract_table()
    print(table)	
		]]>
		</programlisting>
		<screen>
		<![CDATA[]]>
		</screen>
	</section>
	<section>
		<title>保存数据到 Excel</title>
		<screen>
		<![CDATA[
neo@MacBook-Pro-Neo ~/workspace/python % pip install openpyxl		
		]]>
		</screen>
		<programlisting>
		<![CDATA[
import os,pdfplumber

import pandas as pd

file = os.path.expanduser("~/tmp/每日开放式基金净值表.pdf")

# 读取pdf文件，保存为excel
with pdfplumber.open(file) as pdf:
    first_page = pdf.pages[0]

    # 自动读取表格信息，返回列表
    table = first_page.extract_table()
    # print(table)

    save = pd.DataFrame(table[2:],columns=table[0])
    # 保存excel
    save.to_excel('output.xlsx')		
		]]>
		</programlisting>		
	</section>
</section>